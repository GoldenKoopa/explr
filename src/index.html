<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<base target="_blank">
		<title>
			Explr.fm - Color the world
		</title>

		<link rel="icon" type="image/png" href="assets/img/favicon.png">

		<meta name="description" content="Explr is an interactive map for Last.fm users. Ever wondered where the artists you listen to come from? Or is there are any good bands from Mali? Wonder no more!"/>
	    <meta name="keywords" content="Last.fm, explr.fm, music, map, world map, information visualization, Stockholm, KTH, Royal Institute of Technology, D3.js, student project, user experience, world music" />
	    <meta name="author" content="Tommy Feldt, Daniel Molin, Anna Movin, Moa Bergsmark">
	    <meta name="og:title" content="Explr.fm - Color the world">
		<meta name="og:description" content="Explr is an interactive map for Last.fm users. Ever wondered where the artists you listen to come from? Or is there are any good bands from Mali? Wonder no more!">
		<meta name="og:image" content="assets/img/explr-logo.png">
		<meta name="twitter:site" content="Explr.fm">
		<meta name="twitter:image:alt" content="Explr.fm logo">

		
		<meta name="flattr:id" content="2rkoov">

	    <meta name="robots" content="index, follow" />
	    <meta name="revisit-after" content="1 month" />
		<link rel="stylesheet" type="text/css" href="assets/css/main.min.css">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
		<link href='https://fonts.googleapis.com/css?family=Didact+Gothic|Patua+One' rel='stylesheet' type='text/css'>

		<link rel="icon" type="image/png" href="assets/img/favicon.png">




		<script type="application/ld+json">
        [
        {
		  "@context": "https://schema.org",
		  "@type": "WebSite",
		  "name": "Explr.fm",
		  "alternateName": "Explr.fm - Color the world",
		  "url": "https://mold.github.io/explr"
		},
		{
		  "@context": "https://schema.org",
		  "@type": "Organization",
		  "name": "Explr.fm",
		  "url": "https://mold.github.io/explr",
		  "sameAs": [
		    "https://www.facebook.com/explr.fm/"
		  ]
		}
		]
		</script>

		<!-- google analytics -->
		<script>
		  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
		  ga('create', 'UA-49535535-1', 'auto');
		  ga('send', 'pageview');
		</script>

		<!--<link rel="stylesheet" type="text/css" href="new/loader.css">-->

		<link href="https://fonts.googleapis.com/css?family=Cookie" rel="stylesheet">
	</head>
	<body>
		<!-- Google Tag Manager -->
		<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-T6ZGWR"
		height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
		<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
		new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
		j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
		'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
		})(window,document,'script','dataLayer','GTM-T6ZGWR');</script>
		<!-- End Google Tag Manager -->
		<main>
		<div id="welcome-container">
			<div class="welcome-message">
				<h1 class="visually-hidden">Explr.fm – Color the world!</h1>
				<div class="logoImageWelcome"><img alt="Explr.fm logotype" src="assets/img/explrlogo.png" width="200"></div>
				<div id="splashTextContainer">
					<div id="splashContent" class="splash">
						<p class="info">
						Ever wondered where the artists you listen to come from?</p>
						<p class="info">
							Or if there are any good bands from <span id="randomCountry"></span></p>
							
							<p style="text-align: center;" ><strong>Wonder no more!</strong></p>
							<p class="info">Enter your Last.fm username in the field below. If you don't have Last.fm, <a href="https://last.fm">get it here!</a></p>
							<form id="start-form" class="no-select" target="_self">
								<label for="username">
									Last.fm username
									<input id="username" name="username" class="usernameinput" placeholder="e.g. elfummel" type="text" autofocus required autocomplete="on">

								</label>
								<div class="gobutton"><input type="submit" value="&nbsp;" aria-label="Go Explr!"></div>
							</form>
							
					</div>
					<div id="faqtext" class="hidden">
						<h2>Q: So how does this work exactly?</h2>
						<p>A: We fetch your entire Last.fm library and use the tags to determine where each artist you've listened to comes from. This is done by running the artist tags from Last.fm against a list of country names and <a href="https://en.wikipedia.org/wiki/Demonym">demonyms</a>. If an artist is tagged with more than one country, the most popular tag is used. </p>
						<h2>Q: What the heck, France isn't in South America!</h2>
						<p>A: Actually, French Guiana is in South America and <a href="https://en.wikipedia.org/wiki/French_Guiana">French Guiana is an overseas region of France</a>.</p>
						<h2>Q: Hey, Artist X isn't from country Y!</h2>
						<p>A: An artist's associated country is determined by its user-generated tags on last.fm, and these are not always correct. Mistakes will often occur when there are more than one artist with the same name. It's a problem with the data that we can't do anything about.</p>
						<h2>Q: What happened to the artist images?</h2>
						<p>A: We miss them too! Last.fm removed all artist images from their API. Send us a message if you know some other way we might get images! </p>
						<h2>Q: Could you add a new feature or fix a bug?</h2>
						<p>Sure, probably! Please <a href="https://github.com/mold/explr/issues">create an issue on our Github page</a> and we will have a look.</p>
						<p class="details-p">Do you have any other questions or feedback? Send us an email at <a href="mailto:explr.fm@gmail.com">explr.fm@gmail.com</a> or check out our <a href="https://www.reddit.com/r/Music/comments/22n6t8/lastfm_user_heres_an_interactive_map_to_show_the/">reddit post</a>.</p>
					</div>
					<div id="a11ytext" class="hidden info">
						<h1>Accessibility information</h1>
						<p>Explr.fm is now accessible using keyboard commands! It has been tested to work with screen readers VoiceOver for Mac + NVDA and JAWS for Windows.</p>
						<p>You can navigate the map by free text searching for a country or an artist. Open the search bar with the shortcut <kbd>ctrl + f</kbd>.</p>
						<h2>List of keyboard commands</h2>
						<dl>
							<dt><kbd>ctrl + f</kbd></dt>
							<dd>Open search</dd>
							<dt><kbd>esc</kbd></dt>
							<dd>Close search or country view</dd>
							<dt><kbd>down/up arrow</kbd></dt>
							<dd>Navigate search results</dd>
							<dt><kbd>enter</kbd></dt>
							<dd>Activate highlighted search result</dd>
						</dl>
						<h2>Remove animations</h2>
						<p>Be default, the map is animated when zooming into and out of countries. If you do not want this, you can set a system-level accessibility setting to reduce animations. Explr.fm will respect this setting.</p>
						<h2>Did you find an accessibility bug or something that didn't work quite right?</h2>
						<p>Send an e-mail to Tommy (<a href="mailto:tommy.feldt@useit.se">tommy.feldt@useit.se</a>) and he will be happy to fix it!</p>
					</div>
					</div>
					<button class="splash-link faq" type="button">Frequently asked questions -></button>
					<button class="splash-link a11y" type="button">Accessibility information -></button>
					<button class="splash-link back hidden" type="button"><- Go back</button>
					
					<div class="donate">
						<p class="donate__title">
							Show your support with a small donation:
						</p>
						<div class="donate__list">
							<a href="https://flattr.com/@explr.fm" target="_blank" aria-label="Flattr">
								<svg data-v-4ca227fc="" xmlns="https://www.w3.org/2000/svg" viewBox="0 0 1901 500" class="flattr-logo"><path data-v-4ca227fc="" d="M39.71,250C39.71,134,134,39.71,250,39.71c1,0,83.39,0,113.64.05L302.7,100.7l28,28L456.31,0H374L250,0A250,250,0,0,0,0,250L0,444.4l39.78-36.64v-2C39.74,400.67,39.71,251.5,39.71,250Z"></path> <path data-v-4ca227fc="" d="M500,55.59,460.21,92.24v2c0,5.09.07,154.26.07,155.76,0,116-94.34,210.29-210.29,210.29-1,0-83.39,0-113.64-.05L197.3,399.3l-28-28L43.69,500H126l124,0A250,250,0,0,0,500,250Z"></path> <path data-v-4ca227fc="" d="M731.5,69.28H929.82v33.24H768.48V244H906.76v33.24H768.48V446.08h-37Z"></path> <path data-v-4ca227fc="" d="M993.61,69.28h36.45v305c0,35.38,16.08,40.74,30,40.74a83.24,83.24,0,0,0,9.08-.53v32.68a92.22,92.22,0,0,1-13.4,1.07c-22.51,0-62.18-7-62.18-65.94Z"></path> <path data-v-4ca227fc="" d="M1271.78,279.37h15v-7c0-52-28.41-69.68-67-69.68-44.5,0-76.1,25.72-76.1,25.72l-17.16-27.87S1161.92,170,1222.48,170c64.86,0,100.77,35.91,100.77,103.48V446.1h-34.82V416.6a213.07,213.07,0,0,1,1.07-22.51h-1.07s-22.51,58.42-90,58.42c-45,0-91.66-26.27-91.66-79.88C1106.71,281.48,1225.17,279.37,1271.78,279.37Zm-67.53,142c51.45,0,82.55-53.59,82.55-100.23v-11.8h-15.54c-42.34,0-127.08,1.62-127.08,61.11C1144.23,395.69,1164.06,421.41,1204.25,421.41Z"></path> <path data-v-4ca227fc="" d="M1416,210.24h-35.38V179.69h35.91V102h35.91v77.72H1520v30.55h-67.53v134c0,63.25,40.19,71.29,60.56,71.29a62.71,62.71,0,0,0,12.33-1.07v32.68a95.87,95.87,0,0,1-15.54,1.07c-31.08,0-93.8-10.18-93.8-100.23Z"></path> <path data-v-4ca227fc="" d="M1595.56,210.24h-35.38V179.69h35.91V102H1632v77.72h67.53v30.55H1632v134c0,63.25,40.19,71.29,60.56,71.29a62.71,62.71,0,0,0,12.33-1.07v32.68a95.87,95.87,0,0,1-15.54,1.07c-31.08,0-93.8-10.18-93.8-100.23Z"></path> <path data-v-4ca227fc="" d="M1764.94,176.48h35.91v47.71c0,11.8-1.07,21.44-1.07,21.44h1.07c12.85-40.74,42.88-71.82,85.22-71.82a73,73,0,0,1,14.52,1.6v35.91a92.3,92.3,0,0,0-13.4-1.07c-38.12,0-66.46,30-78.26,69.68a177.91,177.91,0,0,0-7.5,52.52V446.06H1765Z"></path></svg>
							</a>
							<a class="bmc-button" target="_blank" href="https://www.buymeacoffee.com/explrfm"><img src="https://www.buymeacoffee.com/assets/img/BMC-btn-logo.svg" alt=""><span style="margin-left:2px">Buy me a coffee</span></a>
						</div>
					</div>
					
					<div id="made-by">
						Made by 
						<ul aria-label="Made by">
							<li><a href="https://se.linkedin.com/pub/anna-movin/50/463/1a0" target="_blank">Anna</a></li>
							<li><a href="https://se.linkedin.com/pub/daniel-molin/82/211/b75" target="_blank">Daniel</a></li>
							<li><a href="https://se.linkedin.com/pub/moa-bergsmark/49/554/93a" target="_blank">Moa</a></li>
							<li><a href="https://se.linkedin.com/in/tommyfeldt" target="_blank">Tommy</a></li>
						</ul>
					</div>

					<div class="social-icons">
						<a aria-label="Explr.fm on Facebook" href="https://www.facebook.com/explr.fm"><img src="assets/img/facebook-icon.svg" alt=""></a>
						<a aria-label="Explr.fm on GitHub" href="https://github.com/mold/explr"><img src="assets/img/github-icon.svg" alt=""></a>
						<a aria-label="Reddit thread about Explr.fm" href="https://www.reddit.com/r/Music/comments/22n6t8/lastfm_user_heres_an_interactive_map_to_show_the/"><img src="assets/img/reddit-icon.svg" alt=""></a>
					</div>
				</div>
			</div>
			<div id="map-container"></div>
			<span class="visually-hidden" id="map-hint">Navigate the map by searching for a country or an artist (shortcut CTRL + F)</span>
			<div class="loader no-select" aria-live="polite">
				<div class="bubblingG">
					<span id="bubblingG_1">
					</span>
					<span id="bubblingG_2">
					</span>
					<span id="bubblingG_3">
					</span>
				</div>
				<div id="loading-text" class="no-select"></div>
			</div>

			<div id="controls" role="group" aria-label="Explr.fm controls">
				<div class="button-group" >
					<div role="search" style="display: flex; align-items: center; gap: 4px;">
						<button aria-labelledby="search-button-label" type="button" aria-expanded="false" id="search-button" class="change-button on-map-view no-select" aria-haspopup="true">
							<img src="assets/img/search.png" alt="" width="28" height="28">
						</button>
						<label class="button-group__label" for="search-button" id="search-button-label">Search (ctrl + f)</label>
					</div>
					<button aria-labelledby="change-theme-button-label" type="button" id="change-theme-button" class="change-button on-map-view no-select"
					onClick="nextTheme();ga('send', 'event', 'Buttons', 'Cycle theme', 'test');">
						<img src="assets/img/glyphicons_009_magic.png" alt="" width="32" height="32">
					</button>
					<label id="change-theme-button-label" class="button-group__label" for="change-theme-button">Change theme (t)</label>
				</div>
				
				<div class="button-group">
					<button aria-labelledby="clear-cache-button-label" type="button" id="clear-cache-button" class="change-button on-map-view no-select"
						onClick="clearExplrCache().then(()=>window.location.reload())">
						<img src="assets/img/refresh.png" alt="" width="28" height="28">
					</button>
					<label id="clear-cache-button-label" class="button-group__label" for="clear-cache-button">Clear cached artists</label>
					<button aria-labelledby="change-user-button-label" type="button" class="change-button on-map-view no-select" id="change-user-button" onclick="window.location.href='./'">
						<img src="assets/img/remove-user.png" alt="" width="32" height="32">
					</button>
					<label class="button-group__label" id="change-user-button-label" for="change-user-button">Change user</label>
				</div>
				<div class="button-group">
					<button aria-labelledby="export-button-label" type="button" id="export-button" class="change-button on-map-view no-select" onClick="utils.exportToCSV(countryCountObj)">
						<img src="assets/img/file-export-solid.png" alt="" width="30" height="30" style="padding: 5px 0 0 5px;">
					</button>
					<label id="export-button-label" for="export-button" class="button-group__label">Export data (e)</label>
					<button aria-labelledby="snapshot-button-label" type="button" id="snapshot-button" class="change-button on-map-view no-select"
						onClick="screenshot.render();ga('send', 'event', 'Buttons', 'Take screenshot', 'test');">
						<img src="assets/img/snapshot.png" alt="" width="32" height="32">
					</button>
					<label id="snapshot-button-label" for="snapshot-button" class="button-group__label">Take snapshot (s)</label>
				</div>
				<div id="countryCount" class="progress on-map-view full-opacity no-select">
					<div id="progress-bar">
						<span id="progress-text"></span><!-- class="hidden" -->
					</div>
				</div>
			</div>
			<div id="search-container" class="search-container"></div>
		</main>
		<footer>
			
			<div id="friends" class="on-map-view" role="group" aria-labelledby="msg">
				<p id="msg" class="details-p"></p>
				<div class="friends-inner">
					<button type="button" aria-label="Previous" class="arrow left no-select"><-</button>
					<div id="friend-name" class="details-p">No friends :-/</div>
					<button type="button" aria-label="Next" class="arrow right no-select">-></button>
				</div>
			</div>
			<div id="logo" class="logo on-map-view no-select">
				<img src="assets/img/explrlogo.png" width="100" alt="Explr.fm logotype">
			</div>

			<div class="screenshot-overlay" style="display:none;" role="dialog" aria-modal="false" aria-label="Screenshot">
				<div class="screenshot-overlay__header">Right click + Save image as...</div>
				<button type="button" class="screenshot-overlay__close" onclick="screenshot.close();">X</button>
				<div><img class="screenshot-overlay__img" src="" alt="Screenshot of your Explr.fm map" id="screenshot-img"></div>
			</div>

			<div class="no-countries" aria-hidden="true">
				<div class="no-countries__title">Artists without a country ▲</div>
				<div class="no-countries__content">
					<p>
						For some reason we couldn't determine the country for these artists. Help out by giving them a country tag on last.fm!
					</p>
					<p class="no-countries__info"></p>
					<ul>
					</ul>
				</div>
			</div>

			<div class="artist-test" onkeydown="event.stopPropagation()">
				<form action="" >
					<input type="text" name="query" placeholder="artist name here"> <button>where from??? 🕵️‍♂️🔎🔎</button>
				</form>
			</div>
			<!-- Labels used for screen reader labels -->
			<span class="hidden" id="map-label">Your world map</span>
			<span class="hidden" id="showing">Currently showing</span>
			<span class="hidden" id="music-from">Music from</span>
			<span class="hidden" id="tags-for">Tags for</span>
			</footer>
		

			<script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
			<script src="https://d3js.org/topojson.v1.min.js"></script>
			<script src="https://d3js.org/d3.geo.projection.v0.min.js"></script>

			<!-- localForage -->
			<script src="https://cdnjs.cloudflare.com/ajax/libs/localforage/1.7.3/localforage.min.js" integrity="sha256-H/ZsHjKSJUnQyCQHZwPmn7VTWFeTTI+qgCP1GkiB9zI=" crossorigin="anonymous"></script>

			<!-- json2csv -->
			<script src="https://cdn.jsdelivr.net/npm/json2csv@5"></script>
			
			<!-- Show and hide FAQ page on click -->
			<script>
				document.querySelector(".splash-link.faq").addEventListener("click", function(){
					document.getElementById("faqtext").classList.remove("hidden");
					document.getElementById("splashContent").classList.add("hidden");
					document.querySelector(".splash-link.faq").classList.add("hidden");
					document.querySelector(".splash-link.a11y").classList.add("hidden");
					document.querySelector(".splash-link.back").classList.remove("hidden");
				});
				document.querySelector(".splash-link.a11y").addEventListener("click", function(){
					document.getElementById("splashContent").classList.add("hidden");
					document.querySelector(".splash-link.faq").classList.add("hidden");
					document.querySelector(".splash-link.a11y").classList.add("hidden");
					document.querySelector(".splash-link.back").classList.remove("hidden");
					document.getElementById("a11ytext").classList.remove("hidden");
					document.getElementById("faqtext").classList.add("hidden");

				});
				document.querySelector(".splash-link.back").addEventListener("click", function(){
					document.getElementById("splashContent").classList.remove("hidden");
					document.querySelector(".splash-link.faq").classList.remove("hidden");
					document.querySelector(".splash-link.a11y").classList.remove("hidden");
					document.querySelector(".splash-link.back").classList.add("hidden");
					document.getElementById("a11ytext").classList.add("hidden");
					document.getElementById("faqtext").classList.add("hidden");
				});
			
			</script>

			<script>
				// Please toggle artist test on press escape pleas
				{
					let showArtistSearch = false;
					let artistTestEl = document.getElementsByClassName("artist-test")[0];
					let form = artistTestEl.children[0];

					window.addEventListener("keypress", (evt) => {
						if(!(evt.code === "KeyF" && evt.ctrlKey && evt.shiftKey)){ return; } 
						evt.preventDefault(); evt.stopPropagation();
						showArtistSearch = !showArtistSearch; 
						artistTestEl.style=`display: ${showArtistSearch ? 'block' : 'none'}`;
						artistTestEl.querySelector("input").focus();
					});

					form.addEventListener("submit", evt => {
						evt.preventDefault();
						let artist = form.elements.query.value;
						api.getCountry(artist, countryInfo => api.getTags(artist, tags => {
							 alert("Country: " + JSON.stringify(countryInfo) + "\n\nTags: " + tags.map(t => `(${t.count}) ${t.name}`).join(", "));
						}));
					})
				}
			</script>
			
			<script src="assets/js/all.min.js"></script>
			<!-- Canvg for screenshots -->
			<!-- Required to convert named colors to RGB -->
			<!-- <script src="https://cdn.jsdelivr.net/npm/rgbcolor@^1/index.js"></script> -->
			<!-- Optional if you want blur -->
			<script src="https://cdn.jsdelivr.net/npm/stackblur-canvas@^1/dist/stackblur.min.js"></script>
			<!-- Main canvg code -->
			<script src="https://cdn.jsdelivr.net/npm/canvg/dist/browser/canvg.min.js"></script>
		</body>
	</html>